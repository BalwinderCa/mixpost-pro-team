import{u as O,l as q,I as z,T as M,N as R,c as $,a,b as e,e as m,w as s,k as Z,F as g,o as n,Z as G,g as b,f as p,t as c,j as C,h as k,R as H,i as J,U as K,aa as Q,r as W,bw as X,m as Y,a0 as y,ak as T,n as ee}from"./app.02c7459f.js";import{u as te}from"./usePostVersions.8b3eb955.js";import{u as ae}from"./Variable.0eaa09f3.js";import{u as se}from"./useTemplate.105812c1.js";import{_ as oe}from"./PageHeader.ca32a0c2.js";import{_ as re}from"./Panel.30e9fcce.js";import{_ as le}from"./LabelSuffix.39e31413.js";import{_ as ie}from"./VerticalGroup.b44ff91a.js";import{_ as me,a as ne,b as pe,c as de,d as ue,e as ce}from"./VariableManager.ecf069a6.js";import{T as fe}from"./Trash.4a91c762.js";import{_ as _e}from"./Flex.d1bb12d6.js";import"./index.ca3912e7.js";import"./index.316f7c4a.js";import"./vue.runtime.esm-bundler.56d01ab9.js";import"./MediaGifs.c2d6f934.js";import"./index.browser.8e74d592.js";import"./Masonry.a74c4c08.js";import"./MediaFile.9ef1dcdd.js";import"./ExclamationCircle.70f35379.js";import"./SectionTitle.7cbe1738.js";import"./SearchInput.9560fa3a.js";import"./NoResult.90dab0cf.js";import"./Alert.e0955a42.js";import"./Tab.203b4d79.js";import"./EllipsisVertical.b7e378de.js";import"./ListItem.4f1def85.js";import"./Textarea.b0fd3982.js";const xe={class:"w-full mx-auto row-py"},ve={class:"flex"},we={class:"mt-lg row-px w-full"},be=["onSubmit"],ke={for:"template_name"},ye={class:"form-field"},$e={class:"relative flex items-center justify-between border-t border-gray-200 pt-md mt-md"},ge={class:"flex items-center space-x-xs"},We={__name:"CreateEdit",props:["template"],setup(h){const d=h,{t:o}=O(),l=d.template?q.exports.cloneDeep(d.template):null;X("postCtx",{});const f=Y("workspaceCtx"),{notify:v}=ee(),{versionContentObject:j}=te(),{insertEmoji:S,insertContent:I,focusEditor:B}=ae(),{createPost:U,formatTemplateContent:A,deleteTemplate:D}=se(),u=z(!1),_=M({name:l?l.name:"",content:l?l.content:[j()]}),E=R(()=>d.template?o("template.edit_template"):o("template.create_new_template")),w=()=>({name:_.name,content:A(_.content)}),F=()=>{d.template||V(w()),d.template&&P(w())},V=(x,t=!1)=>{y.start(),u.value=!0,axios.post(route("mixpost.templates.api.store",{workspace:f.id}),x).then(r=>{if(v("success",o("template.template_created")),!t){T.get(route("mixpost.templates.edit",{workspace:f.id,template:r.data.id}),{},{preserveScroll:!0});return}T.get(route("mixpost.templates.create",{workspace:f.id}))}).finally(()=>{y.done(),u.value=!1})},P=x=>{y.start(),u.value=!0,axios.put(route("mixpost.templates.api.update",{workspace:f.id,template:d.template.id}),x).then(()=>{v("success",o("template.template_updated"))}).catch(t=>{if(t.response.status!==422){v("error",t.response.data.message);return}v("error",o("template.error_saving_template"))}).finally(()=>{y.done(),u.value=!1})};return(x,t)=>(n(),$(g,null,[a(e(G),{title:e(E)},null,8,["title"]),m("div",xe,[a(oe,{title:e(E)},{default:s(()=>[m("div",ve,[e(l)?(n(),b(C,{key:0,onClick:t[0]||(t[0]=()=>{e(U)(w().content)}),class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.use_template")),1)]),_:1})):k("",!0),e(l)?(n(),b(e(J),{key:1,href:x.route("mixpost.templates.create",{workspace:e(f).id})},{default:s(()=>[a(H,{class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.create_new")),1)]),_:1})]),_:1},8,["href"])):k("",!0),e(l)?(n(),b(K,{key:2,onClick:t[1]||(t[1]=()=>{e(D)(e(l))}),size:"sm"},{default:s(()=>[a(fe)]),_:1})):k("",!0)])]),_:1},8,["title"]),m("div",we,[m("form",{onSubmit:Z(F,["prevent"])},[a(re,null,{title:s(()=>[p(c(e(o)("general.details")),1)]),default:s(()=>[a(ie,{class:"mb-lg !max-w-full"},{title:s(()=>[m("label",ke,[p(c(e(o)("template.template_name"))+" ",1),a(le,{danger:!0},{default:s(()=>[p("*")]),_:1})])]),default:s(()=>[a(Q,{type:"text",modelValue:e(_).name,"onUpdate:modelValue":t[2]||(t[2]=r=>e(_).name=r),id:"template_name",required:""},null,8,["modelValue"])]),_:1}),m("div",ye,[(n(!0),$(g,null,W(e(_).content,(r,L)=>(n(),$(g,{key:L},[a(me,{id:"templateEditor",value:r.body,editable:!0,onUpdate:N=>r.body=N,placeholder:e(o)("post.type_something")},{default:s(N=>[m("div",$e,[m("div",ge,[a(ne,{onSelected:t[3]||(t[3]=i=>e(S)({editorId:"templateEditor",emoji:i})),onClose:t[4]||(t[4]=i=>e(B)({editorId:"templateEditor"}))}),a(pe,{onInsert:i=>r.media=[...r.media,...i],selectedAccounts:[],activeVersion:0,versions:[],media:r.media},null,8,["onInsert","media"]),a(de,{editAllowed:!0,onInsert:t[5]||(t[5]=i=>e(I)({editorId:"templateEditor",text:i}))}),a(ue,{editAllowed:!0,onInsert:t[6]||(t[6]=i=>e(I)({editorId:"templateEditor",text:i}))})])])]),_:2},1032,["value","onUpdate","placeholder"]),a(ce,{media:r.media},null,8,["media"])],64))),128))]),a(_e,{responsive:!1,class:"items-center"},{default:s(()=>[a(C,{disabled:u.value,type:"submit",class:"mr-xs"},{default:s(()=>[p(c(e(o)("template.save_template")),1)]),_:1},8,["disabled"]),e(l)?k("",!0):(n(),b(C,{key:0,onClick:t[7]||(t[7]=()=>{V(w(),!0)}),disabled:u.value,type:"button"},{default:s(()=>[p(c(e(o)("template.save_create_new")),1)]),_:1},8,["disabled"]))]),_:1})]),_:1})],40,be)])])],64))}};export{We as default};
